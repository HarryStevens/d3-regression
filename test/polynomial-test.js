const tape = require("tape"),
      d3 = require("../");

function shuffle(arr){
  var m = arr.length, t, i;
  while (m) {
    i = Math.floor(Math.random() * m--);
    t = arr[m];
    arr[m] = arr[i];
    arr[i] = t;
  }
  return arr;
}

tape("polynomial.domain(domain) sets the domain explicitly", function(test) {
  const r = d3.regressionPoly().domain([0, 50]);
  test.deepEqual(r.domain(), [0, 50]);
  test.end();
});

tape("polynomial.order(order) sets the order explicitly", function(test) {
  const r = d3.regressionPoly().order(3);
  test.equal(r.order(), 3);
  test.end();
});

tape("polynomial(data) calculates the the a and b coefficients, R^2, and returns a line representing the regression", function(test) {
  const data = [{"x": 0, "y": 140}, {"x": 1, "y": 149}, {"x": 2, "y": 159.6}, {"x": 3, "y": 159}, {"x": 4, "y": 155.9}, {"x": 5, "y": 169}, {"x": 6, "y": 162.9}, {"x": 7, "y": 169}, {"x": 8, "y": 180}];
  const r = d3.regressionPoly()
    .x(d => d.x)
    .y(d => d.y)
    (shuffle(data));

  [139.76666666666588, 13.453571428572847, -2.9952380952385265, 0.24166666666670067].forEach((c, i) => {
    test.equal(r.coefficients[i].toFixed(4), c.toFixed(4));
  });
  test.equal(r.rSquared.toFixed(4), 0.920356511364995.toFixed(4));


  [[0,139.76666666666668],[0.0625,140.5958737327939],[0.125,141.40203450520835],[0.15625,141.79658315749396],[0.1875,142.18550298781622],[0.21875,142.56883824666343],[0.25,142.94663318452382],[0.28125,143.3189320518857],[0.3125,143.68577909923738],[0.34375,144.04721857706707],[0.375,144.4032947358631],[0.40625,144.75405182611377],[0.4375,145.09953409830732],[0.46875,145.43978580293202],[0.5,145.7748511904762],[0.53125,146.1047745114281],[0.5625,146.42960001627605],[0.59375,146.74937195550828],[0.625,147.0641345796131],[0.65625,147.3739321390788],[0.6875,147.67880888439362],[0.71875,147.97880906604587],[0.75,148.27397693452383],[0.78125,148.5643567403158],[0.8125,148.84999273390997],[0.84375,149.13092916579475],[0.875,149.40721028645834],[0.90625,149.67888034638906],[0.9375,149.94598359607517],[0.96875,150.20856428600496],[1,150.46666666666667],[1.03125,150.72033498854867],[1.0625,150.96961350213914],[1.09375,151.21454645792642],[1.109375,151.33539717992147],[1.125,151.45517810639882],[1.140625,151.5738947686695],[1.15625,151.69155269804457],[1.171875,151.80815742583502],[1.1875,151.92371448335194],[1.203125,152.03822940190636],[1.21875,152.15170771280927],[1.234375,152.2641549473717],[1.25,152.37557663690478],[1.265625,152.48597831271948],[1.28125,152.59536550612677],[1.296875,152.7037437484378],[1.3125,152.81111857096357],[1.328125,152.91749550501504],[1.34375,153.02288008190337],[1.359375,153.1272778329395],[1.375,153.23069428943455],[1.390625,153.33313498269945],[1.40625,153.4346054440453],[1.421875,153.53511120478314],[1.4375,153.634657796224],[1.453125,153.73325074967886],[1.46875,153.8308955964588],[1.484375,153.9275978678749],[1.5,154.02336309523812],[1.515625,154.1181968098595],[1.53125,154.21210454305015],[1.546875,154.30509182612104],[1.5625,154.39716419038317],[1.578125,154.48832716714767],[1.59375,154.57858628772556],[1.609375,154.6679470834278],[1.625,154.7564150855655],[1.640625,154.84399582544964],[1.65625,154.9306948343913],[1.671875,155.0165176437015],[1.6875,155.10146978469123],[1.703125,155.1855567886716],[1.71875,155.2687841869536],[1.734375,155.3511575108483],[1.75,155.43268229166668],[1.765625,155.51336406071982],[1.78125,155.59320834931876],[1.796875,155.67222068877444],[1.8125,155.75040661039807],[1.828125,155.82777164550055],[1.84375,155.90432132539297],[1.859375,155.98006118138633],[1.875,156.05499674479168],[1.890625,156.12913354692006],[1.90625,156.20247711908252],[1.9140625,156.2388531724612],[1.921875,156.27503299259007],[1.9296875,156.31101727088293],[1.9375,156.34680669875374],[1.9453125,156.38240196761632],[1.953125,156.4178037688846],[1.9609375,156.45301279397242],[1.96875,156.48802973429366],[1.9765625,156.5228552812622],[1.984375,156.55749012629192],[1.9921875,156.59193496079672],[2,156.6261904761905],[2.0078125,156.66025736388707],[2.015625,156.69413631530037],[2.0234375,156.72782802184426],[2.03125,156.7613331749326],[2.0390625,156.79465246597925],[2.046875,156.82778658639816],[2.0546875,156.86073622760318],[2.0625,156.8935020810082],[2.0703125,156.92608483802707],[2.078125,156.95848519007367],[2.0859375,156.99070382856192],[2.09375,157.02274144490562],[2.1015625,157.05459873051873],[2.109375,157.08627637681508],[2.1171875,157.11777507520858],[2.125,157.14909551711312],[2.1328125,157.18023839394255],[2.140625,157.21120439711075],[2.1484375,157.24199421803158],[2.15625,157.27260854811894],[2.1640625,157.30304807878676],[2.171875,157.33331350144886],[2.1796875,157.36340550751913],[2.1875,157.3933247884115],[2.1953125,157.42307203553975],[2.203125,157.45264794031783],[2.2109375,157.48205319415956],[2.21875,157.5112884884789],[2.2265625,157.54035451468968],[2.234375,157.5692519642058],[2.2421875,157.59798152844112],[2.25,157.62654389880956],[2.2578125,157.65493976672494],[2.265625,157.68316982360116],[2.2734375,157.71123476085208],[2.28125,157.73913526989165],[2.2890625,157.7668720421337],[2.296875,157.79444576899212],[2.3046875,157.8218571418808],[2.3125,157.84910685221357],[2.3203125,157.87619559140435],[2.328125,157.903124050867],[2.3359375,157.92989292201543],[2.34375,157.9565028962635],[2.3515625,157.9829546650251],[2.359375,158.00924891971408],[2.3671875,158.03538635174436],[2.375,158.06136765252978],[2.3828125,158.08719351348424],[2.390625,158.1128646260216],[2.3984375,158.13838168155579],[2.40625,158.16374537150065],[2.4140625,158.18895638727008],[2.421875,158.21401542027795],[2.4296875,158.23892316193812],[2.4375,158.26368030366447],[2.4453125,158.28828753687088],[2.453125,158.31274555297128],[2.4609375,158.33705504337948],[2.46875,158.3612166995094],[2.4765625,158.38523121277493],[2.484375,158.40909927458992],[2.4921875,158.43282157636827],[2.5,158.45639880952382],[2.5078125,158.47983166547047],[2.515625,158.50312083562216],[2.5234375,158.5262670113927],[2.53125,158.54927088419598],[2.5390625,158.5721331454459],[2.546875,158.5948544865563],[2.5546875,158.6174355989411],[2.5625,158.63987717401415],[2.5703125,158.66217990318935],[2.578125,158.6843444778806],[2.5859375,158.7063715895017],[2.59375,158.72826192946664],[2.6015625,158.7500161891892],[2.609375,158.77163506008333],[2.6171875,158.79311923356286],[2.625,158.81446940104166],[2.6328125,158.8356862539337],[2.640625,158.85677048365275],[2.6484375,158.87772278161276],[2.65625,158.8985438392276],[2.6640625,158.91923434791113],[2.671875,158.93979499907724],[2.6796875,158.96022648413978],[2.6875,158.98052949451267],[2.6953125,159.00070472160976],[2.703125,159.02075285684495],[2.7109375,159.04067459163213],[2.71875,159.06047061738516],[2.7265625,159.0801416255179],[2.734375,159.09968830744427],[2.7421875,159.1191113545781],[2.75,159.13841145833334],[2.75390625,159.1480156225108],[2.7578125,159.15758931012383],[2.76171875,159.16713260759911],[2.765625,159.17664560136342],[2.76953125,159.1861283778435],[2.7734375,159.19558102346605],[2.77734375,159.20500362465782],[2.78125,159.21439626784556],[2.78515625,159.22375903945596],[2.7890625,159.23309202591582],[2.79296875,159.2423953136518],[2.796875,159.25166898909072],[2.80078125,159.26091313865922],[2.8046875,159.27012784878414],[2.80859375,159.27931320589212],[2.8125,159.28846929640997],[2.81640625,159.29759620676438],[2.8203125,159.3066940233821],[2.82421875,159.31576283268987],[2.828125,159.3248027211144],[2.83203125,159.33381377508246],[2.8359375,159.34279608102074],[2.83984375,159.35174972535603],[2.84375,159.360674794515],[2.84765625,159.36957137492445],[2.8515625,159.37843955301105],[2.85546875,159.3872794152016],[2.859375,159.39609104792277],[2.86328125,159.4048745376014],[2.8671875,159.41362997066406],[2.87109375,159.42235743353766],[2.875,159.4310570126488],[2.87890625,159.43972879442433],[2.8828125,159.44837286529088],[2.88671875,159.45698931167524],[2.890625,159.46557822000415],[2.89453125,159.4741396767043],[2.8984375,159.4826737682025],[2.90234375,159.4911805809254],[2.90625,159.4996602012998],[2.91015625,159.50811271575236],[2.9140625,159.5165382107099],[2.91796875,159.5249367725991],[2.921875,159.53330848784677],[2.92578125,159.54165344287952],[2.9296875,159.5499717241242],[2.93359375,159.55826341800747],[2.9375,159.5665286109561],[2.94140625,159.57476738939684],[2.9453125,159.5829798397564],[2.94921875,159.5911660484615],[2.953125,159.5993261019389],[2.95703125,159.60746008661533],[2.9609375,159.61556808891754],[2.96484375,159.62365019527223],[2.96875,159.63170649210613],[2.97265625,159.63973706584602],[2.9765625,159.6477420029186],[2.98046875,159.65572138975065],[2.984375,159.66367531276885],[2.98828125,159.67160385839998],[2.9921875,159.6795071130707],[2.99609375,159.68738516320786],[3,159.6952380952381],[3.00390625,159.70306599558822],[3.0078125,159.7108689506849],[3.01171875,159.71864704695489],[3.015625,159.72640037082493],[3.01953125,159.73412900872177],[3.0234375,159.74183304707213],[3.02734375,159.74951257230273],[3.03125,159.75716767084032],[3.03515625,159.76479842911164],[3.0390625,159.77240493354344],[3.04296875,159.77998727056243],[3.046875,159.78754552659535],[3.05078125,159.79507978806893],[3.0546875,159.80259014140992],[3.05859375,159.81007667304505],[3.0625,159.81753946940105],[3.06640625,159.82497861690467],[3.0703125,159.83239420198262],[3.07421875,159.83978631106163],[3.078125,159.84715503056847],[3.08203125,159.85450044692985],[3.0859375,159.8618226465725],[3.08984375,159.86912171592317],[3.09375,159.87639774140857],[3.09765625,159.8836508094555],[3.1015625,159.89088100649062],[3.10546875,159.89808841894072],[3.109375,159.9052731332325],[3.11328125,159.91243523579269],[3.1171875,159.91957481304806],[3.12109375,159.9266919514253],[3.125,159.93378673735123],[3.12890625,159.94085925725247],[3.1328125,159.94790959755582],[3.13671875,159.954937844688],[3.140625,159.96194408507577],[3.14453125,159.96892840514582],[3.1484375,159.97589089132492],[3.15234375,159.98283163003978],[3.15625,159.98975070771718],[3.16015625,159.9966482107838],[3.1640625,160.0035242256664],[3.16796875,160.01037883879175],[3.171875,160.01721213658652],[3.17578125,160.02402420547747],[3.1796875,160.03081513189136],[3.18359375,160.0375850022549],[3.1875,160.04433390299482],[3.19140625,160.05106192053788],[3.1953125,160.05776914131076],[3.19921875,160.06445565174027],[3.203125,160.07112153825307],[3.20703125,160.07776688727597],[3.2109375,160.08439178523562],[3.21484375,160.09099631855887],[3.21875,160.09758057367233],[3.22265625,160.10414463700283],[3.2265625,160.11068859497706],[3.23046875,160.11721253402177],[3.234375,160.1237165405637],[3.23828125,160.13020070102954],[3.2421875,160.1366651018461],[3.24609375,160.14310982944002],[3.25,160.14953497023814],[3.25390625,160.1559406106671],[3.2578125,160.1623268371537],[3.26171875,160.16869373612462],[3.265625,160.17504139400666],[3.26953125,160.1813698972265],[3.2734375,160.18767933221093],[3.27734375,160.1939697853866],[3.28125,160.20024134318035],[3.28515625,160.20649409201883],[3.2890625,160.21272811832884],[3.29296875,160.21894350853705],[3.296875,160.22514034907024],[3.30078125,160.23131872635514],[3.3046875,160.23747872681847],[3.30859375,160.24362043688697],[3.3125,160.24974394298738],[3.31640625,160.25584933154644],[3.3203125,160.26193668899083],[3.32421875,160.26800610174737],[3.328125,160.27405765624272],[3.33203125,160.28009143890372],[3.3359375,160.28610753615698],[3.33984375,160.2921060344293],[3.34375,160.29808702014742],[3.34765625,160.30405057973806],[3.3515625,160.30999679962795],[3.35546875,160.31592576624385],[3.359375,160.32183756601245],[3.36328125,160.32773228536053],[3.3671875,160.33361001071478],[3.37109375,160.339470828502],[3.375,160.34531482514885],[3.37890625,160.35114208708208],[3.3828125,160.35695270072847],[3.38671875,160.3627467525147],[3.390625,160.3685243288676],[3.39453125,160.3742855162138],[3.3984375,160.3800304009801],[3.40234375,160.38575906959318],[3.40625,160.39147160847983],[3.41015625,160.39716810406674],[3.4140625,160.4028486427807],[3.41796875,160.40851331104838],[3.421875,160.41416219529654],[3.42578125,160.41979538195193],[3.4296875,160.42541295744127],[3.43359375,160.4310150081913],[3.4375,160.43660162062875],[3.44140625,160.44217288118037],[3.4453125,160.44772887627283],[3.44921875,160.45326969233298],[3.453125,160.45879541578748],[3.45703125,160.46430613306308],[3.4609375,160.4698019305865],[3.46484375,160.4752828947845],[3.46875,160.4807491120838],[3.47265625,160.48620066891115],[3.4765625,160.49163765169328],[3.48046875,160.4970601468569],[3.484375,160.50246824082876],[3.48828125,160.50786202003562],[3.4921875,160.51324157090417],[3.49609375,160.51860697986118],[3.5,160.52395833333338],[3.50390625,160.52929571774743],[3.5078125,160.5346192195302],[3.51171875,160.53992892510834],[3.515625,160.54522492090862],[3.51953125,160.55050729335775],[3.5234375,160.55577612888246],[3.52734375,160.5610315139095],[3.53125,160.56627353486562],[3.53515625,160.57150227817755],[3.5390625,160.57671783027197],[3.54296875,160.58192027757568],[3.546875,160.58710970651538],[3.55078125,160.59228620351783],[3.5546875,160.59744985500973],[3.55859375,160.60260074741788],[3.5625,160.6077389671689],[3.56640625,160.61286460068965],[3.5703125,160.6179777344068],[3.57421875,160.6230784547471],[3.578125,160.62816684813728],[3.58203125,160.63324300100408],[3.5859375,160.63830699977422],[3.58984375,160.64335893087446],[3.59375,160.64839888073152],[3.59765625,160.65342693577213],[3.6015625,160.65844318242304],[3.60546875,160.66344770711095],[3.609375,160.66844059626266],[3.61328125,160.6734219363048],[3.6171875,160.67839181366426],[3.62109375,160.68335031476758],[3.625,160.68829752604168],[3.6328125,160.69815842480887],[3.640625,160.7079752013797],[3.6484375,160.71774854716801],[3.65625,160.72747915358772],[3.6640625,160.7371677120527],[3.671875,160.74681491397678],[3.6796875,160.75642145077387],[3.6875,160.76598801385788],[3.6953125,160.77551529464267],[3.703125,160.78500398454213],[3.7109375,160.79445477497012],[3.71875,160.80386835734052],[3.7265625,160.81324542306723],[3.734375,160.8225866635641],[3.7421875,160.831892770245],[3.75,160.84116443452382],[3.7578125,160.85040234781448],[3.765625,160.85960720153085],[3.7734375,160.86877968708677],[3.78125,160.87792049589615],[3.7890625,160.88703031937283],[3.796875,160.8961098489307],[3.8046875,160.90515977598372],[3.8125,160.91418079194568],[3.8203125,160.9231735882305],[3.828125,160.93213885625207],[3.8359375,160.9410772874242],[3.84375,160.94998957316085],[3.8515625,160.95887640487584],[3.859375,160.96773847398305],[3.8671875,160.9765764718964],[3.875,160.98539109002976],[3.8828125,160.99418301979702],[3.890625,161.00295295261205],[3.8984375,161.0117015798887],[3.90625,161.02042959304086],[3.921875,161.03782654262724],[3.9375,161.0551493326823],[3.953125,161.07240349451703],[3.96875,161.08959455944247],[3.984375,161.1067280587696],[4,161.12380952380954],[4.25,161.3945498511905],[4.265625,161.41159302393595],[4.28125,161.42868372599284],[4.296875,161.4458274886722],[4.3125,161.463029843285],[4.328125,161.4802963211423],[4.34375,161.49763245355516],[4.3515625,161.50632836875462],[4.359375,161.51504377183463],[4.3671875,161.523779354209],[4.375,161.53253580729168],[4.3828125,161.5413138224965],[4.390625,161.5501140912374],[4.3984375,161.5589373049282],[4.40625,161.5677841549828],[4.4140625,161.5766553328151],[4.421875,161.58555152983897],[4.4296875,161.59447343746825],[4.4375,161.60342174711687],[4.4453125,161.61239715019863],[4.453125,161.6214003381275],[4.4609375,161.63043200231735],[4.46875,161.63949283418202],[4.4765625,161.64858352513542],[4.484375,161.65770476659142],[4.4921875,161.66685724996387],[4.5,161.67604166666666],[4.5078125,161.6852587081137],[4.515625,161.69450906571888],[4.5234375,161.70379343089604],[4.53125,161.71311249505908],[4.5390625,161.72246694962186],[4.546875,161.7318574859983],[4.5546875,161.7412847956022],[4.5625,161.7507495698475],[4.5703125,161.76025250014806],[4.578125,161.76979427791778],[4.5859375,161.77937559457055],[4.59375,161.7889971415202],[4.6015625,161.79865961018066],[4.609375,161.80836369196575],[4.6171875,161.8181100782894],[4.625,161.82789946056548],[4.6328125,161.83773253020786],[4.640625,161.84760997863043],[4.64453125,161.85256556095115],[4.6484375,161.8575324972471],[4.65234375,161.862510873945],[4.65625,161.86750077747166],[4.66015625,161.87250229425376],[4.6640625,161.87751551071807],[4.66796875,161.88254051329127],[4.671875,161.88757738840016],[4.67578125,161.89262622247142],[4.6796875,161.8976871019318],[4.68359375,161.90276011320807],[4.6875,161.90784534272694],[4.69140625,161.91294287691514],[4.6953125,161.9180528021994],[4.69921875,161.9231752050065],[4.703125,161.92831017176312],[4.70703125,161.93345778889602],[4.7109375,161.93861814283193],[4.71484375,161.94379131999756],[4.71875,161.9489774068197],[4.72265625,161.95417648972503],[4.7265625,161.95938865514032],[4.73046875,161.9646139894923],[4.734375,161.96985257920767],[4.73828125,161.9751045107132],[4.7421875,161.98036987043562],[4.74609375,161.9856487448017],[4.75,161.9909412202381],[4.75390625,161.9962473831716],[4.7578125,162.00156732002895],[4.76171875,162.00690111723685],[4.765625,162.01224886122208],[4.76953125,162.0176106384113],[4.7734375,162.0229865352313],[4.77734375,162.0283766381088],[4.78125,162.03378103347055],[4.78515625,162.03919980774324],[4.7890625,162.0446330473537],[4.79296875,162.05008083872855],[4.796875,162.05554326829457],[4.80078125,162.06102042247852],[4.8046875,162.06651238770712],[4.80859375,162.07201925040712],[4.8125,162.07754109700522],[4.81640625,162.08307801392817],[4.8203125,162.08863008760272],[4.82421875,162.0941974044556],[4.828125,162.09978005091352],[4.83203125,162.10537811340325],[4.8359375,162.11099167835147],[4.83984375,162.116620832185],[4.84375,162.12226566133046],[4.84765625,162.12792625221473],[4.8515625,162.1336026912644],[4.85546875,162.1392950649063],[4.859375,162.1450034595671],[4.86328125,162.15072796167362],[4.8671875,162.15646865765254],[4.87109375,162.1622256339306],[4.875,162.16799897693454],[4.87890625,162.17378877309108],[4.8828125,162.179595108827],[4.88671875,162.18541807056894],[4.890625,162.19125774474375],[4.89453125,162.19711421777808],[4.8984375,162.2029875760987],[4.90234375,162.20887790613233],[4.90625,162.21478529430576],[4.91015625,162.22070982704562],[4.9140625,162.22665159077874],[4.91796875,162.23261067193178],[4.921875,162.23858715693157],[4.92578125,162.24458113220476],[4.9296875,162.25059268417814],[4.93359375,162.2566218992784],[4.9375,162.2626688639323],[4.94140625,162.26873366456658],[4.9453125,162.27481638760796],[4.94921875,162.28091711948318],[4.953125,162.28703594661897],[4.95703125,162.2931729554421],[4.9609375,162.2993282323792],[4.96484375,162.30550186385716],[4.96875,162.31169393630256],[4.97265625,162.31790453614227],[4.9765625,162.3241337498029],[4.98046875,162.3303816637113],[4.984375,162.33664836429415],[4.98828125,162.3429339379782],[4.9921875,162.34923847119015],[4.99609375,162.35556205035678],[5,162.36190476190478],[5.00390625,162.36826669226093],[5.0078125,162.37464792785192],[5.01171875,162.38104855510454],[5.015625,162.38746866044548],[5.01953125,162.39390833030146],[5.0234375,162.4003676510993],[5.02734375,162.4068467092656],[5.03125,162.41334559122723],[5.03515625,162.41986438341084],[5.0390625,162.42640317224323],[5.04296875,162.43296204415105],[5.046875,162.43954108556113],[5.05078125,162.44614038290013],[5.0546875,162.45276002259484],[5.05859375,162.45940009107196],[5.0625,162.4660606747582],[5.06640625,162.47274186008036],[5.0703125,162.47944373346513],[5.07421875,162.48616638133927],[5.078125,162.49290989012948],[5.08203125,162.49967434626254],[5.0859375,162.50645983616513],[5.08984375,162.51326644626403],[5.09375,162.52009426298596],[5.09765625,162.52694337275767],[5.1015625,162.53381386200587],[5.10546875,162.54070581715732],[5.109375,162.54761932463873],[5.11328125,162.55455447087687],[5.1171875,162.56151134229845],[5.12109375,162.5684900253302],[5.125,162.57549060639883],[5.12890625,162.58251317193114],[5.1328125,162.58955780835382],[5.13671875,162.5966246020936],[5.140625,162.60371363957728],[5.14453125,162.61082500723148],[5.1484375,162.61795879148303],[5.15234375,162.62511507875863],[5.15625,162.63229395548504],[5.16015625,162.63949550808897],[5.1640625,162.64671982299714],[5.16796875,162.65396698663633],[5.171875,162.66123708543324],[5.17578125,162.66853020581465],[5.1796875,162.67584643420722],[5.18359375,162.68318585703773],[5.1875,162.6905485607329],[5.19140625,162.6979346317195],[5.1953125,162.70534415642422],[5.19921875,162.71277722127385],[5.203125,162.72023391269505],[5.20703125,162.7277143171146],[5.2109375,162.73521852095922],[5.21484375,162.74274661065567],[5.21875,162.7502986726307],[5.22265625,162.75787479331098],[5.2265625,162.76547505912328],[5.23046875,162.77309955649434],[5.234375,162.7807483718509],[5.23828125,162.78842159161968],[5.2421875,162.79611930222742],[5.24609375,162.80384159010083],[5.25,162.8115885416667],[5.25390625,162.8193602433517],[5.2578125,162.82715678158266],[5.26171875,162.83497824278618],[5.265625,162.8428247133891],[5.26953125,162.8506962798181],[5.2734375,162.85859302849997],[5.27734375,162.8665150458614],[5.28125,162.87446241832916],[5.28515625,162.88243523232995],[5.2890625,162.8904335742905],[5.29296875,162.89845753063761],[5.296875,162.90650718779793],[5.30078125,162.91458263219826],[5.3046875,162.92268395026528],[5.30859375,162.93081122842577],[5.3125,162.93896455310642],[5.31640625,162.94714401073404],[5.3203125,162.95534968773526],[5.32421875,162.9635816705369],[5.328125,162.97184004556564],[5.33203125,162.9801248992483],[5.3359375,162.9884363180115],[5.33984375,162.9967743882821],[5.34375,163.0051391964867],[5.34765625,163.01353082905214],[5.3515625,163.02194937240512],[5.35546875,163.03039491297235],[5.359375,163.0388675371806],[5.36328125,163.0473673314566],[5.3671875,163.05589438222708],[5.37109375,163.06444877591872],[5.375,163.07303059895838],[5.37890625,163.08163993777265],[5.3828125,163.0902768787884],[5.38671875,163.09894150843223],[5.390625,163.107633913131],[5.39453125,163.11635417931137],[5.3984375,163.1251023934001],[5.40234375,163.13387864182394],[5.40625,163.1426830110096],[5.41015625,163.1515155873838],[5.4140625,163.16037645737333],[5.41796875,163.16926570740486],[5.421875,163.17818342390518],[5.42578125,163.187129693301],[5.4296875,163.196104602019],[5.43359375,163.20510823648604],[5.4375,163.21414068312873],[5.44140625,163.2232020283739],[5.4453125,163.2322923586482],[5.44921875,163.24141176037847],[5.453125,163.25056031999134],[5.45703125,163.25973812391362],[5.4609375,163.268945258572],[5.46484375,163.27818181039325],[5.46875,163.28744786580407],[5.47265625,163.2967435112312],[5.4765625,163.3060688331014],[5.48046875,163.31542391784137],[5.484375,163.3248088518779],[5.48828125,163.33422372163764],[5.4921875,163.3436686135474],[5.49609375,163.35314361403388],[5.5,163.36264880952382],[5.50390625,163.37218428644397],[5.5078125,163.38175013122105],[5.51171875,163.3913464302818],[5.515625,163.40097327005296],[5.51953125,163.41063073696125],[5.5234375,163.42031891743343],[5.53125,163.43978776477636],[5.5390625,163.45938050349557],[5.546875,163.47909782500497],[5.5546875,163.49894042071844],[5.5625,163.51890898204985],[5.5703125,163.53900420041313],[5.578125,163.5592267672221],[5.5859375,163.5795773738907],[5.59375,163.6000567118327],[5.6015625,163.6206654724621],[5.609375,163.64140434719272],[5.6171875,163.6622740274384],[5.625,163.6832752046131],[5.6328125,163.70440857013068],[5.640625,163.725674815405],[5.6484375,163.74707463184996],[5.65625,163.7686087108794],[5.6640625,163.7902777439072],[5.671875,163.81208242234732],[5.6796875,163.83402343761352],[5.6875,163.8561014811198],[5.6953125,163.87831724427997],[5.703125,163.90067141850793],[5.7109375,163.92316469521754],[5.71875,163.94579776582268],[5.7265625,163.96857132173724],[5.734375,163.9914860543751],[5.7421875,164.0145426551501],[5.75,164.0377418154762],[5.7578125,164.06108422676724],[5.765625,164.0845705804371],[5.7734375,164.10820156789964],[5.78125,164.13197788056874],[5.7890625,164.15590020985832],[5.796875,164.1799692471822],[5.8046875,164.20418568395434],[5.8125,164.22855021158855],[5.8203125,164.25306352149875],[5.828125,164.27772630509878],[5.8359375,164.30253925380256],[5.84375,164.32750305902394],[5.8515625,164.35261841217678],[5.859375,164.37788600467502],[5.8671875,164.4033065279325],[5.875,164.42888067336312],[5.8828125,164.45460913238074],[5.890625,164.48049259639924],[5.8984375,164.50653175683252],[5.90625,164.53272730509443],[5.9140625,164.55907993259885],[5.921875,164.5855903307597],[5.9296875,164.6122591909908],[5.9375,164.63908720470613],[5.9453125,164.66607506331945],[5.953125,164.69322345824472],[5.9609375,164.7205330808958],[5.96875,164.7480046226865],[5.9765625,164.77563877503079],[5.984375,164.8034362293425],[5.9921875,164.83139767703557],[6,164.85952380952384],[6.0078125,164.88781531822116],[6.015625,164.91627289454144],[6.0234375,164.94489722989857],[6.03125,164.97368901570638],[6.0390625,165.00264894337883],[6.046875,165.03177770432973],[6.0546875,165.061075989973],[6.0625,165.0905444917225],[6.0703125,165.12018390099212],[6.078125,165.1499949091957],[6.0859375,165.17997820774715],[6.09375,165.21013448806036],[6.1015625,165.24046444154922],[6.109375,165.27096875962758],[6.1171875,165.30164813370934],[6.125,165.33250325520837],[6.1328125,165.36353481553851],[6.140625,165.3947435061137],[6.1484375,165.42613001834778],[6.15625,165.45769504365467],[6.1640625,165.48943927344823],[6.171875,165.52136339914233],[6.1796875,165.55346811215085],[6.1875,165.5857541038877],[6.1953125,165.6182220657667],[6.203125,165.65087268920175],[6.2109375,165.68370666560673],[6.21875,165.71672468639557],[6.2265625,165.74992744298208],[6.234375,165.78331562678022],[6.2421875,165.8168899292038],[6.25,165.85065104166668],[6.2578125,165.8845996555828],[6.265625,165.918736462366],[6.2734375,165.9530621534302],[6.28125,165.98757742018927],[6.2890625,166.0222829540571],[6.296875,166.0571794464475],[6.3046875,166.0922675887744],[6.3125,166.12754807245165],[6.3203125,166.1630215888932],[6.328125,166.19868882951283],[6.3359375,166.2345504857245],[6.34375,166.27060724894207],[6.3515625,166.30685981057943],[6.359375,166.3433088620504],[6.375,166.41679920014883],[6.390625,166.4910837945484],[6.40625,166.5661681765602],[6.421875,166.6420578774952],[6.4375,166.71875842866447],[6.453125,166.796275361379],[6.46875,166.8746142069499],[6.484375,166.95378049668813],[6.5,167.03377976190475],[6.515625,167.11461753391086],[6.53125,167.1962993440174],[6.546875,167.27883072353546],[6.5625,167.36221720377605],[6.578125,167.44646431605022],[6.59375,167.53157759166902],[6.609375,167.61756256194343],[6.625,167.70442475818453],[6.640625,167.79216971170337],[6.65625,167.88080295381096],[6.671875,167.97033001581832],[6.6875,168.06075642903647],[6.703125,168.15208772477652],[6.71875,168.24432943434942],[6.734375,168.3374870890663],[6.75,168.4315662202381],[6.765625,168.52657235917593],[6.78125,168.62251103719078],[6.796875,168.71938778559368],[6.8125,168.8172081356957],[6.828125,168.91597761880786],[6.84375,169.0157017662412],[6.859375,169.1163861093067],[6.875,169.2180361793155],[6.890625,169.32065750757857],[6.90625,169.42425562540694],[6.921875,169.52883606411163],[6.9375,169.63440435500374],[6.953125,169.74096602939426],[6.96875,169.8485266185942],[6.984375,169.9570916539147],[7,170.0666666666667],[7.015625,170.17725718816124],[7.03125,170.28886874970937],[7.046875,170.40150688262213],[7.0625,170.5151771182106],[7.078125,170.62988498778572],[7.09375,170.74563602265857],[7.109375,170.86243575414025],[7.125,170.9802897135417],[7.140625,171.09920343217397],[7.15625,171.21918244134812],[7.171875,171.3402322723752],[7.1875,171.46235845656622],[7.21875,171.70986200968426],[7.25,171.9617373511905],[7.28125,172.2180287315732],[7.3125,172.4787804013207],[7.34375,172.74403661092126],[7.375,173.0138416108631],[7.40625,173.2882396516346],[7.4375,173.567274983724],[7.46875,173.85099185761953],[7.5,174.1394345238095],[7.53125,174.4326472327823],[7.5625,174.73067423502604],[7.59375,175.0335597810291],[7.625,175.34134812127976],[7.65625,175.6540835062663],[7.6875,175.97181018647694],[7.71875,176.29457241240002],[7.75,176.62241443452382],[7.78125,176.9553805033366],[7.8125,177.29351486932666],[7.84375,177.63686178298224],[7.875,177.9854654947917],[7.90625,178.33937025524324],[7.9375,178.69862031482518],[7.96875,179.06325992402577],[8,179.43333333333337]]
  .forEach((p, i) => {
    test.deepEqual(r[i].map(d => d.toFixed(4)), p.map(d => d.toFixed(4)));
  });

  test.end();
});