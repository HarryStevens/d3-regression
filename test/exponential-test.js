const tape = require("tape"),
      d3 = require("../");

function shuffle(arr){
  var m = arr.length, t, i;
  while (m) {
    i = Math.floor(Math.random() * m--);
    t = arr[m];
    arr[m] = arr[i];
    arr[i] = t;
  }
  return arr;
}

tape("exp.domain(domain) sets the domain explicitly", function(test) {
  const r = d3.regressionExp().domain([0, 50]);
  test.deepEqual(r.domain(), [0, 50]);
  test.end();
});

tape("exp(data) calculates the the a and b coefficients, R^2, and returns a line representing the regression", function(test) {
  const data = [{x: 0, y: 3}, {x: 1, y: 7}, {x: 2, y: 10}, {x: 3, y: 24}, {x: 4, y: 50}, {x: 5, y: 95}];
  const r = d3.regressionExp()
    .x(d => d.x)
    .y(d => d.y)
    .domain([-2, 5.06])
    (shuffle(data));
  
  test.equal(r.a.toFixed(3), "3.033");
  test.equal(r.b.toFixed(3), "0.691");
  test.equal(r.rSquared.toFixed(3), "0.998");

  [[-2,0.7617573113942196],[-1.99310546875,0.7653943220666074],[-1.9862109375,0.7690486976483084],[-1.9793164062500002,0.7727205210480912],[-1.972421875,0.776409875570572],[-1.9655273437499998,0.780116844918105],[-1.9586328124999999,0.7838415131926815],[-1.95173828125,0.7875839648978373],[-1.94484375,0.7913442849405716],[-1.93794921875,0.7951225586332706],[-1.9310546875,0.7989188716956457],[-1.9241601562500001,0.8027333102566764],[-1.917265625,0.806565960856565],[-1.9103710937499998,0.810416910448701],[-1.9034765624999999,0.8142862464016318],[-1.89658203125,0.8181740565010464],[-1.8896875,0.8220804289517666],[-1.88279296875,0.8260054523797484],[-1.8758984375,0.8299492158340923],[-1.8690039062500001,0.8339118087890633],[-1.862109375,0.8378933211461224],[-1.8552148437499998,0.841893843235964],[-1.8483203124999998,0.8459134658205671],[-1.84142578125,0.849952280095254],[-1.83453125,0.8540103776907585],[-1.82763671875,0.8580878506753056],[-1.8207421875,0.8621847915567005],[-1.81384765625,0.8663012932844264],[-1.806953125,0.8704374492517545],[-1.8000585937499998,0.8745933532978613],[-1.7931640624999998,0.8787690997099592],[-1.7862695312499999,0.8829647832254347],[-1.779375,0.8871804990339983],[-1.77248046875,0.8914163427798435],[-1.7655859375,0.8956724105638169],[-1.75869140625,0.8999487989455992],[-1.751796875,0.9042456049458949],[-1.7449023437499998,0.9085629260486341],[-1.7380078124999998,0.9129008602031836],[-1.7311132812499999,0.91725950582657],[-1.72421875,0.9216389618057117],[-1.71732421875,0.926039327499663],[-1.7104296875,0.9304607027418682],[-1.70353515625,0.9349031878424257],[-1.696640625,0.9393668835903656],[-1.6897460937499997,0.943851891255934],[-1.6828515624999998,0.9483583125928928],[-1.6759570312499998,0.9528862498408269],[-1.6690625,0.9574358057274643],[-1.66216796875,0.9620070834710067],[-1.6552734375,0.9666001867824708],[-1.64837890625,0.9712152198680418],[-1.6414843749999999,0.9758522874314374],[-1.638037109375,0.9781791169988594],[-1.6345898437499997,0.9805114946762833],[-1.6311425781249997,0.9828494336926639],[-1.6276953124999998,0.9851929473084996],[-1.6242480468749998,0.9875420488159082],[-1.6208007812499998,0.9898967515387],[-1.6173535156249998,0.9922570688324557],[-1.6139062499999999,0.9946230140846007],[-1.610458984375,0.996994600714481],[-1.60701171875,0.9993718421734408],[-1.603564453125,1.001754751944897],[-1.6001171875,1.004143343544417],[-1.596669921875,1.0065376305197944],[-1.59322265625,1.0089376264511263],[-1.589775390625,1.0113433449508908],[-1.586328125,1.0137547996640228],[-1.5828808593750001,1.0161720042679934],[-1.5794335937500001,1.0185949724728853],[-1.5759863281250002,1.0210237180214723],[-1.5725390625000002,1.023458254689296],[-1.5690917968750002,1.0258985962847453],[-1.5656445312500002,1.0283447566491335],[-1.562197265625,1.0307967496567771],[-1.55875,1.0332545892150746],[-1.555302734375,1.0357182892645858],[-1.55185546875,1.0381878637791102],[-1.548408203125,1.0406633267657661],[-1.5449609375,1.0431446922650713],[-1.541513671875,1.0456319743510216],[-1.53806640625,1.048125187131171],[-1.534619140625,1.0506243447467112],[-1.531171875,1.0531294613725528],[-1.527724609375,1.0556405512174054],[-1.5242773437500001,1.0581576285238568],[-1.5208300781250002,1.0606807075684561],[-1.5173828125000002,1.063209802661793],[-1.5139355468750002,1.06574492814858],[-1.5104882812500002,1.068286098407732],[-1.5070410156250003,1.0708333278524507],[-1.5035937500000003,1.073386630930303],[-1.5001464843750003,1.0759460221233066],[-1.4966992187500003,1.0785115159480088],[-1.4932519531250004,1.0810831269555705],[-1.4898046875000004,1.0836608697318495],[-1.4863574218750004,1.0862447588974804],[-1.4829101562500004,1.0888348091079612],[-1.4794628906250002,1.091431035053734],[-1.4760156250000003,1.0940334514602679],[-1.4725683593750003,1.0966420730881448],[-1.46912109375,1.0992569147331408],[-1.4656738281250001,1.1018779912263128],[-1.4622265625000002,1.1045053174340789],[-1.4587792968750002,1.1071389082583063],[-1.4553320312500002,1.1097787786363935],[-1.4518847656250002,1.1124249435413562],[-1.4484375000000003,1.1150774179819123],[-1.4449902343750003,1.1177362170025658],[-1.4415429687500003,1.1204013556836931],[-1.4380957031250003,1.1230728491416286],[-1.4346484375000004,1.1257507125287507],[-1.4312011718750004,1.128434961033566],[-1.4277539062500004,1.1311256098807976],[-1.4243066406250002,1.1338226743314708],[-1.4208593750000003,1.1365261696829978],[-1.4174121093750003,1.1392361112692682],[-1.41396484375,1.1419525144607325],[-1.4105175781250001,1.144675394664491],[-1.4070703125000001,1.1474047673243806],[-1.4036230468750002,1.1501406479210625],[-1.4001757812500002,1.152883051972111],[-1.3967285156250002,1.1556319950320995],[-1.3932812500000002,1.1583874926926905],[-1.3898339843750003,1.1611495605827231],[-1.3863867187500003,1.1639182143683025],[-1.3829394531250003,1.1666934697528872],[-1.3794921875000004,1.1694753424773798],[-1.3760449218750004,1.172263848320216],[-1.3725976562500004,1.175059003097453],[-1.3691503906250002,1.1778608226628602],[-1.3657031250000002,1.180669322908009],[-1.3622558593750003,1.1834845197623625],[-1.35880859375,1.1863064291933665],[-1.355361328125,1.1891350672065393],[-1.3519140625000001,1.191970449845563],[-1.3484667968750002,1.1948125931923748],[-1.3450195312500002,1.1976615133672568],[-1.3415722656250002,1.20051722652893],[-1.3381250000000002,1.2033797488746423],[-1.3346777343750003,1.2062490966402646],[-1.3312304687500003,1.209125286100379],[-1.3277832031250003,1.2120083335683736],[-1.3243359375000003,1.2148982553965348],[-1.3208886718750004,1.2177950679761382],[-1.3174414062500004,1.2206987877375441],[-1.3139941406250002,1.223609431150289],[-1.3105468750000002,1.226527014723179],[-1.3070996093750002,1.2294515550043847],[-1.30365234375,1.232383068581534],[-1.300205078125,1.2353215720818063],[-1.2967578125,1.2382670821720272],[-1.2933105468750001,1.2412196155587627],[-1.2898632812500002,1.2441791889884137],[-1.2864160156250002,1.2471458192473124],[-1.2829687500000002,1.2501195231618154],[-1.2795214843750002,1.2531003175984008],[-1.2760742187500003,1.2560882194637626],[-1.2726269531250003,1.2590832457049081],[-1.2691796875000003,1.2620854133092523],[-1.2657324218750003,1.2650947393047163],[-1.2622851562500004,1.2681112407598212],[-1.2588378906250002,1.2711349347837877],[-1.2553906250000002,1.274165838526631],[-1.2519433593750002,1.2772039691792596],[-1.24849609375,1.2802493439735716],[-1.245048828125,1.2833019801825531],[-1.2416015625,1.2863618951203761],[-1.2381542968750001,1.2894291061424965],[-1.2347070312500001,1.2925036306457534],[-1.2312597656250002,1.295585486068466],[-1.2278125000000002,1.2986746898905341],[-1.2243652343750002,1.3017712596335367],[-1.2209179687500002,1.3048752128608314],[-1.2174707031250003,1.307986567177654],[-1.2140234375000003,1.3111053402312178],[-1.2105761718750003,1.3142315497108155],[-1.2071289062500004,1.317365213347917],[-1.2036816406250002,1.3205063489162718],[-1.2002343750000002,1.3236549742320096],[-1.1967871093750002,1.3268111071537403],[-1.19333984375,1.3299747655826564],[-1.189892578125,1.3331459674626343],[-1.1864453125,1.3363247307803352],[-1.182998046875,1.3395110735653086],[-1.1795507812500001,1.3427050138900942],[-1.1761035156250002,1.3459065698703223],[-1.1726562500000002,1.3491157596648198],[-1.1692089843750002,1.3523326014757109],[-1.1657617187500002,1.3555571135485218],[-1.1623144531250003,1.3587893141722822],[-1.1588671875000003,1.362029221679632],[-1.1554199218750003,1.3652768544469218],[-1.1519726562500003,1.3685322308943202],[-1.1485253906250001,1.3717953694859168],[-1.1450781250000002,1.3750662887298266],[-1.1416308593750002,1.3783450071782952],[-1.13818359375,1.3816315434278061],[-1.134736328125,1.3849259161191823],[-1.1312890625,1.388228143937695],[-1.127841796875,1.3915382456131689],[-1.12439453125,1.394856239920088],[-1.1209472656250001,1.3981821456777022],[-1.1175000000000002,1.4015159817501346],[-1.1140527343750002,1.4048577670464877],[-1.1106054687500002,1.408207520520951],[-1.1071582031250002,1.4115652611729088],[-1.1037109375000003,1.4149310080470472],[-1.1002636718750003,1.4183047802334627],[-1.0968164062500003,1.4216865968677712],[-1.0933691406250001,1.4250764771312145],[-1.0899218750000002,1.4284744402507707],[-1.0864746093750002,1.4318805054992638],[-1.08302734375,1.4352946921954703],[-1.079580078125,1.4387170197042318],[-1.0761328125,1.4421475074365635],[-1.072685546875,1.4455861748497638],[-1.06923828125,1.449033041447526],[-1.0657910156250001,1.4524881267800474],[-1.0623437500000001,1.4559514504441413],[-1.0588964843750002,1.459423032083348],[-1.0554492187500002,1.4629028913880453],[-1.0520019531250002,1.4663910480955613],[-1.0485546875000002,1.4698875219902867],[-1.0451074218750003,1.4733923329037848],[-1.0416601562500003,1.4769055007149066],[-1.038212890625,1.480427045349902],[-1.0347656250000001,1.4839569867825326],[-1.0313183593750002,1.4874953450341863],[-1.02787109375,1.4910421401739906],[-1.024423828125,1.4945973923189244],[-1.0209765625,1.4981611216339352],[-1.017529296875,1.5017333483320514],[-1.01408203125,1.505314092674497],[-1.010634765625,1.508903374970808],[-1.0071875000000001,1.5125012155789461],[-1.0037402343750002,1.5161076349054143],[-1.0002929687500002,1.519722653405374],[-0.9968457031250002,1.5233462915827587],[-0.9933984375000001,1.526978569990393],[-0.989951171875,1.5306195092301071],[-0.9865039062500001,1.5342691299528541],[-0.9830566406250001,1.5379274528588278],[-0.9796093750000001,1.54159449869758],[-0.9761621093750001,1.5452702882681373],[-0.9727148437500002,1.5489548424191197],[-0.9692675781250002,1.5526481820488596],[-0.9658203125000001,1.5563503281055182],[-0.962373046875,1.560061301587207],[-0.95892578125,1.563781123542104],[-0.9554785156250001,1.5675098150685767],[-0.9520312500000001,1.5712473973152978],[-0.9485839843750001,1.5749938914813684],[-0.9451367187500002,1.5787493188164359],[-0.9416894531250002,1.582513700620816],[-0.9382421875000001,1.5862870582456134],[-0.934794921875,1.5900694130928414],[-0.93134765625,1.5938607866155459],[-0.9279003906250001,1.5976612003179245],[-0.9244531250000001,1.6014706757554498],[-0.9210058593750001,1.6052892345349916],[-0.9175585937500002,1.6091168983149393],[-0.9141113281250002,1.6129536888053249],[-0.9106640625000001,1.6167996277679455],[-0.907216796875,1.6206547370164874],[-0.90376953125,1.6245190384166495],[-0.9003222656250001,1.6283925538862678],[-0.8968750000000001,1.6322753053954393],[-0.8934277343750001,1.636167314966646],[-0.8899804687500001,1.6400686046748814],[-0.8865332031250002,1.6439791966477737],[-0.8830859375000001,1.6478991130657143],[-0.879638671875,1.6518283761619794],[-0.87619140625,1.6557670082228595],[-0.872744140625,1.6597150315877847],[-0.8692968750000001,1.6636724686494517],[-0.8658496093750001,1.6676393418539492],[-0.8624023437500001,1.6716156737008887],[-0.8589550781250002,1.6756014867435278],[-0.8555078125000001,1.6795968035889017],[-0.852060546875,1.6836016468979496],[-0.84861328125,1.6876160393856425],[-0.845166015625,1.6916400038211146],[-0.8417187500000001,1.695673563027791],[-0.8382714843750001,1.699716739883516],[-0.8348242187500001,1.703769557320685],[-0.8313769531250002,1.7078320383263734],[-0.8279296875000001,1.7119042059424665],[-0.824482421875,1.7159860832657918],[-0.82103515625,1.7200776934482482],[-0.817587890625,1.7241790596969384],[-0.8141406250000001,1.7282902052743014],[-0.8106933593750001,1.7324111534982414],[-0.8072460937500001,1.7365419277422631],[-0.8037988281250001,1.7406825514356037],[-0.8003515625000001,1.7448330480633638],[-0.796904296875,1.7489934411666435],[-0.79345703125,1.7531637543426732],[-0.790009765625,1.7573440112449494],[-0.7865625,1.7615342355833683],[-0.7831152343750001,1.7657344511243602],[-0.7796679687500001,1.7699446816910231],[-0.7762207031250001,1.774164951163261],[-0.7727734375,1.7783952834779158],[-0.769326171875,1.7826357026289046],[-0.76587890625,1.7868862326673567],[-0.762431640625,1.7911468977017482],[-0.758984375,1.7954177218980398],[-0.7555371093750001,1.7996987294798146],[-0.7520898437500001,1.8039899447284131],[-0.7486425781250001,1.8082913919830739],[-0.7451953125,1.8126030956410695],[-0.741748046875,1.8169250801578452],[-0.73830078125,1.8212573700471582],[-0.734853515625,1.8255999898812167],[-0.73140625,1.8299529642908192],[-0.7279589843750001,1.8343163179654942],[-0.7245117187500001,1.838690075653639],[-0.7210644531250001,1.8430742621626626],[-0.7176171875,1.8474689023591238],[-0.714169921875,1.8518740211688745],[-0.71072265625,1.8562896435771987],[-0.707275390625,1.8607157946289568],[-0.703828125,1.865152499428725],[-0.700380859375,1.8695997831409406],[-0.6969335937500001,1.874057670990042],[-0.6934863281250001,1.8785261882606135],[-0.6900390625000001,1.8830053602975276],[-0.6865917968750002,1.8874952125060902],[-0.6831445312500002,1.8919957703521824],[-0.6796972656250002,1.8965070593624083],[-0.6762500000000001,1.9010291051242365],[-0.672802734375,1.9055619332861462],[-0.6693554687500001,1.9101055695577738],[-0.6659082031250001,1.914660039710058],[-0.6624609375000001,1.9192253695753858],[-0.6590136718750002,1.9238015850477388],[-0.6555664062500002,1.9283887120828407],[-0.6521191406250002,1.9329867766983038],[-0.6486718750000001,1.9375958049737783],[-0.645224609375,1.9422158230510973],[-0.6417773437500001,1.9468468571344273],[-0.6383300781250001,1.9514889334904162],[-0.6348828125000001,1.9561420784483428],[-0.6314355468750001,1.9608063184002649],[-0.6279882812500002,1.96548167980117],[-0.6245410156250002,1.9701681891691252],[-0.6210937500000001,1.9748658730854278],[-0.617646484375,1.9795747581947545],[-0.61419921875,1.9842948712053146],[-0.6107519531250001,1.9890262388890012],[-0.6073046875000001,1.9937688880815414],[-0.6038574218750001,1.998522845682651],[-0.6004101562500002,2.003288138656184],[-0.5969628906250002,2.0080647940302883],[-0.5935156250000001,2.0128528388975577],[-0.590068359375,2.017652300415186],[-0.58662109375,2.02246320580512],[-0.5831738281250001,2.0272855823542155],[-0.5797265625000001,2.032119457414392],[-0.5762792968750001,2.036964858402784],[-0.5728320312500002,2.0418218128019046],[-0.5693847656250002,2.0466903481597916],[-0.5659375000000001,2.0515704920901716],[-0.562490234375,2.0564622722726122],[-0.55904296875,2.0613657164526806],[-0.5555957031250001,2.066280852442101],[-0.5521484375000001,2.071207708118912],[-0.5487011718750001,2.0761463114276246],[-0.5452539062500001,2.0810966903793813],[-0.5418066406250002,2.0860588730521146],[-0.5383593750000001,2.0910328875907056],[-0.534912109375,2.0960187622071444],[-0.53146484375,2.1010165251806905],[-0.528017578125,2.1060262048580327],[-0.5245703125000001,2.111047829653449],[-0.5211230468750001,2.11608142804897],[-0.5176757812500001,2.1211270285945374],[-0.5142285156250002,2.126184659908169],[-0.5107812500000001,2.1312543506761186],[-0.507333984375,2.1363361296530408],[-0.50388671875,2.141430025662152],[-0.500439453125,2.1465360675953953],[-0.49699218750000007,2.151654284413604],[-0.49009765625000007,2.1619273588936876],[-0.48320312500000007,2.172249482173125],[-0.47630859375000006,2.1826208884354323],[-0.46941406250000006,2.1930418129822375],[-0.4625195312500001,2.203512492238615],[-0.4556250000000001,2.21403316375845],[-0.4487304687500001,2.2246040662298316],[-0.44183593750000016,2.235225439480463],[-0.43494140625000016,2.245897524483105],[-0.42804687500000016,2.2566205633610443],[-0.42115234375000016,2.2673947993935837],[-0.41425781250000016,2.278220477021564],[-0.40736328125000015,2.28909784185291],[-0.40046875000000015,2.3000271406681994],[-0.39357421875000015,2.3110086214262657],[-0.38667968750000015,2.3220425332698214],[-0.37978515625000014,2.33312912653111],[-0.37289062500000014,2.3442686527375884],[-0.36599609375000014,2.355461364617631],[-0.35910156250000014,2.3667075161062616],[-0.35220703125000014,2.3780073623509197],[-0.34531250000000013,2.389361159717246],[-0.33841796875000013,2.4007691657948973],[-0.33152343750000013,2.412231639403394],[-0.3246289062500001,2.42374884059799],[-0.3177343750000001,2.4353210306755733],[-0.3108398437500001,2.446948472180593],[-0.3039453125000001,2.4586314289110187],[-0.2970507812500001,2.470370165924322],[-0.2901562500000001,2.482164949543491],[-0.2832617187500001,2.494016047363076],[-0.2763671875000001,2.5059237282552544],[-0.2694726562500001,2.517888262375935],[-0.2625781250000001,2.529909921170887],[-0.2556835937500001,2.541988977381897],[-0.2487890625000001,2.5541257050529564],[-0.2418945312500001,2.5663203795364815],[-0.2350000000000001,2.5785732774995576],[-0.2281054687500001,2.5908846769302176],[-0.2212109375000001,2.603254857143749],[-0.2143164062500001,2.6156840987890284],[-0.2074218750000001,2.628172683854893],[-0.2005273437500001,2.640720895676534],[-0.19363281250000008,2.6533290189419274],[-0.18673828125000008,2.6659973396982926],[-0.1798437500000001,2.67872614535858],[-0.1729492187500001,2.6915157247079953],[-0.1660546875000001,2.7043663679105476],[-0.1591601562500001,2.717278366515635],[-0.1522656250000001,2.730252013464659],[-0.1453710937500001,2.7432876030976674],[-0.1384765625000001,2.7563854311600386],[-0.1315820312500001,2.769545794809184],[-0.1246875000000001,2.7827689926212957],[-0.11779296875000012,2.7960553245981155],[-0.11089843750000011,2.8094050921737463],[-0.10400390625000011,2.8228185982214864],[-0.09710937500000011,2.836296147060704],[-0.0902148437500001,2.8498380444637386],[-0.0833203125000001,2.863444597662842],[-0.0764257812500001,2.8771161153571456],[-0.0695312500000001,2.8908529077196645],[-0.0626367187500001,2.9046552864043353],[-0.0557421875000001,2.9185235645530874],[-0.04884765625000011,2.9324580568029446],[-0.041953125000000105,2.946459079293167],[-0.0350585937500001,2.960526949672422],[-0.028164062500000107,2.9746619871059883],[-0.02126953125000011,2.9888645122830027],[-0.01437500000000011,3.003134847423729],[-0.00748046875000011,3.0174733162868757],[-0.0005859375000001107,3.0318802441769335],[0.006308593749999889,3.046355957951562],[0.013203124999999889,3.060900786029002],[0.020097656249999887,3.0755150583955286],[0.02699218749999989,3.090199106612934],[0.03388671874999989,3.104953263826055],[0.04078124999999989,3.1197778647703265],[0.04767578124999988,3.1346732457793802],[0.054570312499999885,3.1496397447926707],[0.06146484374999989,3.1646777013631455],[0.06835937499999989,3.1797874566649478],[0.07525390624999989,3.194969353501157],[0.0821484374999999,3.210223736311567],[0.0890429687499999,3.2255509511804967],[0.09593749999999988,3.2409513458446493],[0.10283203124999987,3.256425269700992],[0.10972656249999987,3.2719730738146913],[0.11662109374999988,3.2875951109270747],[0.12351562499999988,3.3032917354636315],[0.13041015624999988,3.3190633035420563],[0.13730468749999988,3.334910172980328],[0.14419921874999989,3.350832703304828],[0.1510937499999999,3.366831255758497],[0.15798828124999986,3.382906193309028],[0.16488281249999986,3.399057880657106],[0.17177734374999987,3.4152866842446783],[0.17867187499999987,3.4315929722632696],[0.18556640624999987,3.447977114662336],[0.19246093749999987,3.4644394831576557],[0.19935546874999988,3.4809804512397666],[0.20624999999999988,3.497600394182435],[0.21314453124999988,3.5142996890511733],[0.22003906249999988,3.5310787147117932],[0.22693359374999988,3.547937851839001],[0.23382812499999986,3.564877482925035],[0.24072265624999983,3.5818979922883427],[0.24761718749999984,3.5989997660823],[0.25451171874999984,3.616183192303973],[0.26140624999999984,3.63344866080292],[0.26830078124999984,3.6507965632900348],[0.27519531249999984,3.668227293346436],[0.28208984374999985,3.6857412464323955],[0.28898437499999985,3.7033388198963113],[0.29587890624999985,3.7210204129837203],[0.30277343749999985,3.7387864268463566],[0.30966796874999986,3.756637264551257],[0.31656249999999986,3.774573331089898],[0.32345703124999986,3.7925950333873897],[0.33035156249999986,3.8107027803117073],[0.33724609374999986,3.8288969826829646],[0.34414062499999987,3.8471780532827387],[0.35103515624999987,3.8655464068634298],[0.35792968749999987,3.8840024601576744],[0.3648242187499999,3.9025466318878013],[0.3717187499999999,3.921179342775327],[0.3786132812499999,3.9399010155505034],[0.3855078124999999,3.958712074961908],[0.3924023437499999,3.9776129477860827],[0.3992968749999999,3.9966040628372115],[0.4061914062499999,4.015685850976853],[0.4130859374999999,4.0348587451237155],[0.4199804687499999,4.054123180263476],[0.4268749999999999,4.073479593458652],[0.4337695312499999,4.092928423858517],[0.4406640624999999,4.112470112709062],[0.4475585937499999,4.1321051033630045],[0.4544531249999999,4.151833841289857],[0.4613476562499999,4.171656774086018],[0.4682421874999999,4.191574351484941],[0.4751367187499999,4.211587025367329],[0.4820312499999999,4.231695249771393],[0.4889257812499999,4.2518994809031465],[0.4958203124999999,4.272200177146758],[0.50271484375,4.292597799074957],[0.5096093749999999,4.313092809459471],[0.5165039062499999,4.333685673281535],[0.5233984374999999,4.354376857742438],[0.53029296875,4.37516683227412],[0.5371874999999999,4.396056068549823],[0.5440820312499999,4.417045040494795],[0.5509765624999999,4.438134224297042],[0.55787109375,4.459324098418125],[0.5647656249999999,4.480615143604022],[0.5716601562499999,4.502007842896038],[0.5785546874999999,4.523502681641752],[0.58544921875,4.545100147506036],[0.59234375,4.566800730482123],[0.5992382812499999,4.588604922902714],[0.6061328125,4.610513219451157],[0.61302734375,4.632526117172661],[0.619921875,4.654644115485581],[0.6268164062499999,4.676867716192746],[0.6337109374999998,4.699197423492839],[0.6406054687499998,4.721633743991844],[0.6474999999999999,4.744177186714532],[0.6543945312499999,4.766828263116017],[0.6612890624999999,4.789587487093351],[0.6681835937499998,4.8124553749971914],[0.6750781249999998,4.83543244564351],[0.6819726562499997,4.858519220325367],[0.6888671874999998,4.881716222824737],[0.6957617187499998,4.9050239794243895],[0.7026562499999998,4.928443018919834],[0.7095507812499997,4.951973872631314],[0.7164453124999998,4.975617074415858],[0.7233398437499998,4.999373160679402],[0.7302343749999998,5.023242670388945],[0.7371289062499997,5.047226145084791],[0.7440234374999998,5.071324128892822],[0.7509179687499998,5.095537168536858],[0.7578124999999998,5.119865813351041],[0.7647070312499997,5.1443106152923175],[0.7716015624999998,5.168872128952951],[0.7784960937499998,5.193550911573104],[0.7853906249999998,5.218347523053483],[0.7922851562499997,5.243262525968043],[0.7991796874999998,5.268296485576745],[0.8060742187499998,5.293449969838389],[0.8129687499999998,5.318723549423488],[0.8198632812499997,5.344117797727227],[0.8267578124999998,5.369633290882466],[0.8336523437499999,5.395270607772807],[0.8405468749999998,5.421030330045739],[0.8474414062499998,5.446913042125821],[0.8543359374999998,5.472919331227953],[0.8612304687499999,5.499049787370687],[0.8681249999999998,5.525305003389624],[0.8750195312499998,5.551685574950854],[0.8819140624999998,5.57819210056448],[0.8888085937499999,5.60482518159819],[0.8957031249999998,5.6315854222908985],[0.9025976562499998,5.658473429766466],[0.9094921874999998,5.685489814047461],[0.9163867187499999,5.712635188069006],[0.9232812499999998,5.739910167692685],[0.9301757812499998,5.7673153717205095],[0.9370703124999998,5.794851421908964],[0.9439648437499999,5.822518942983111],[0.9508593749999998,5.8503185626507594],[0.9577539062499998,5.878250911616713],[0.9646484374999998,5.906316623597073],[0.9784374999999998,5.962850686608259],[0.9922265624999999,6.019925882187209],[1.0060156249999999,6.077547389944945],[1.0198046874999998,6.135720439070672],[1.0335937499999999,6.194450308806337],[1.0473828125,6.253742328925713],[1.0611718749999999,6.313601880218086],[1.0749609374999998,6.374034394976567],[1.0887499999999999,6.435045357491071],[1.1025390625,6.496640304546023],[1.116328125,6.558824825922822],[1.1301171874999998,6.621604564907121],[1.1439062499999997,6.684985218800957],[1.1576953124999996,6.748972539439784],[1.1714843749999997,6.813572333714458],[1.1852734374999998,6.878790464098212],[1.1990624999999997,6.944632849178685],[1.2128515624999996,7.011105464195031],[1.2266406249999997,7.078214341580186],[1.2404296874999998,7.145965571508302],[1.2542187499999997,7.214365302447443],[1.2680078124999996,7.283419741717561],[1.2817968749999997,7.353135156053818],[1.2955859374999998,7.423517872175281],[1.3093749999999997,7.4945742773590975],[1.3231640624999996,7.566310820020128],[1.3369531249999997,7.638734010296157],[1.3507421874999999,7.711850420638678],[1.3645312499999998,7.785666686409358],[1.3783203124999996,7.8601895064821985],[1.3921093749999998,7.935425643851466],[1.4058984374999999,8.011381926245425],[1.4196874999999998,8.088065246745979],[1.4334765624999997,8.165482564414202],[1.4472656249999998,8.243640904921895],[1.4610546875,8.322547361189152],[1.4748437499999998,8.402209094028072],[1.4886328124999997,8.482633332792577],[1.5024218749999998,8.56382737603451],[1.5162109375,8.645798592165962],[1.5299999999999998,8.728554420127965],[1.5437890624999997,8.812102370065594],[1.5575781249999998,8.896450024009503],[1.5713671875,8.981605036563996],[1.5851562499999998,9.067575135601704],[1.5989453124999997,9.154368122964877],[1.6127343749999998,9.241991875173426],[1.6265234375,9.330454344139698],[1.6403124999999998,9.419763557890132],[1.6541015624999997,9.509927621293816],[1.6678906249999998,9.600954716797988],[1.6816796875,9.69285310517061],[1.6954687499999999,9.785631126250042],[1.7092578124999998,9.87929719970188],[1.7230468749999999,9.973859825783045],[1.7368359375,10.069327586113197],[1.7506249999999999,10.165709144453512],[1.7644140624999998,10.263013247492932],[1.7782031249999999,10.361248725641925],[1.7919921875,10.460424493833857],[1.80578125,10.560549552334022],[1.8195703124999998,10.661632987556429],[1.833359375,10.763683972888396],[1.8471484375,10.86671176952304],[1.8609375,10.970725727299733],[1.8747265624999998,11.075735285552618],[1.888515625,11.181749973967225],[1.9023046875,11.288779413445294],[1.91609375,11.396833316977885],[1.9298828124999998,11.505921490526834],[1.9436718749999997,11.616053833914659],[1.9574609374999996,11.727240341722958],[1.9712499999999997,11.839491104199439],[1.9850390624999998,11.952816308173615],[1.9988281249999997,12.06722623798125],[2.0126171874999996,12.182731276397694],[2.0264062499999995,12.299341905580109],[2.0539843749999998,12.535922367497264],[2.0815624999999995,12.777053505002637],[2.1091406249999993,13.02282285131069],[2.1367187499999996,13.273319623355912],[2.164296875,13.528634754179528],[2.1918749999999996,13.788860925939181],[2.2194531249999994,14.054092603553572],[2.2470312499999996,14.32442606899425],[2.274609375,14.599959456236963],[2.3021874999999996,14.88079278688542],[2.3297656249999994,15.167028006480182],[2.3573437499999996,15.458769021505997],[2.384921875,15.756121737110984],[2.4124999999999996,16.05919409555135],[2.4400781249999994,16.368096115375597],[2.4676562499999997,16.682939931362455],[2.495234375,17.003839835227],[2.5228124999999997,17.330912317109803],[2.5503906249999995,17.66427610786411],[2.5779687499999997,18.00405222215642],[2.605546875,18.350364002396134],[2.6331249999999997,18.703337163510156],[2.6607031249999995,19.063099838578804],[2.6882812499999997,19.429782625349507],[2.715859375,19.80351863364517],[2.7434374999999998,20.184443533684497],[2.7710156249999995,20.572695605331784],[2.7985937499999998,20.968415788293942],[2.826171875,21.371747733283204],[2.85375,21.782837854163823],[2.8813281249999996,22.20183538110194],[2.90890625,22.628892414737752],[2.936484375,23.064163981399656],[2.9640625,23.5078080893805],[2.9916406249999996,23.95998578629631],[3.01921875,24.420861217548346],[3.046796875,24.890601685909587],[3.074375,25.369377712257528],[3.12953125,26.35473498554207],[3.1846875,27.378363948697256],[3.23984375,28.44175109021337],[3.295,29.546440634417266],[3.35015625,30.6940367839565],[3.4053125,31.886206049382423],[3.46046875,33.124679669215354],[3.515625,34.41125612400605],[3.57078125,35.7478037480443],[3.6259375,37.13626344250755],[3.68109375,38.57865149398923],[3.73625,40.07706250249989],[3.79140625,41.63367242319327],[3.8465625,43.25074172623409],[3.90171875,44.930618679396595],[3.956875,46.67574275816054],[4.01203125,48.48864818825668],[4.0671875,50.37196762580638],[4.1775,54.360894386660206],[4.2878125,58.66570193306636],[4.398125,63.31140468034586],[4.5084375,68.3249979207913],[4.61875,73.7356146881597],[4.7290625,79.57469504417347],[4.839375,85.87616877072028],[4.9496875,92.67665252934216],[5.06,100.01566263366955]]
  .forEach((p, i) => {
    test.deepEqual(r[i].map(d => d.toFixed(4)), p.map(d => d.toFixed(4)));
  });

  test.end();
});